@using Pegasus_MVC.ViewModels
@model BookingPreviewVM

<div class="modal fade" id="bookingPreviewModal" tabindex="-1" aria-labelledby="bookingPreviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="bookingPreviewModalLabel">Booking Preview</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="card mb-3">
                    <div class="card-header">
                        <h6 class="mb-0">Contact Information</h6>
                    </div>
                    <div class="card-body">
                        <p class="mb-2"><strong>Name:</strong> @Model.FirstName @Model.LastName</p>
                        <p class="mb-2"><strong>Email:</strong> @Model.Email</p>
                        <p class="mb-0"><strong>Phone:</strong> @Model.PhoneNumber</p>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-header">
                        <h6 class="mb-0">Trip Information</h6>
                    </div>
                    <div class="card-body">
                        <p class="mb-2"><strong>Pick-up Time:</strong> @Model.PickUpDateTime.ToString("yyyy-MM-dd HH:mm")</p>
                        <p class="mb-2"><strong>From:</strong> @Model.PickUpAddress</p>

                        @if (!string.IsNullOrEmpty(Model.FirstStopAddress))
                        {
                            <p class="mb-2"><strong>Stop 1:</strong> @Model.FirstStopAddress</p>
                        }

                        @if (!string.IsNullOrEmpty(Model.SecondStopAddress))
                        {
                            <p class="mb-2"><strong>Stop 2:</strong> @Model.SecondStopAddress</p>
                        }

                        <p class="mb-2"><strong>To:</strong> @Model.DropOffAddress</p>

                        @if (!string.IsNullOrEmpty(Model.Flightnumber))
                        {
                            <p class="mb-2"><strong>Flight Number:</strong> @Model.Flightnumber</p>
                        }

                        @if (!string.IsNullOrEmpty(Model.Comment))
                        {
                            <p class="mb-0"><strong>Comment:</strong> @Model.Comment</p>
                        }
                    </div>
                </div>

                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h6 class="mb-0">Trip Details</h6>
                    </div>
                    <div class="card-body">
                        <p class="mb-2"><strong>Distance:</strong> @Model.DistanceKm.ToString("0.00") km</p>
                        <p class="mb-2"><strong>Duration:</strong> @Model.DurationMinutes.ToString("0") minutes</p>
                        <p class="h5 mt-3 mb-0 text-success"><strong>Total Price:</strong> @Model.Price.ToString("0.00") SEK</p>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" onclick="confirmBooking()">Confirm Booking</button>
            </div>
        </div>
    </div>
</div>

<script>
    function confirmBooking() {
        const modal = bootstrap.Modal.getInstance(document.getElementById('bookingPreviewModal'));
        modal.hide();

        const form = document.getElementById('bookingForm');
        form.action = '/Booking/Create';
        form.submit();
    }
</script>
